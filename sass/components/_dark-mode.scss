/*--------------------------------------------------------------
# Dark Mode Toggle
--------------------------------------------------------------*/

.dark-mode-toggle {
  height: 100%;
  border: none;
  background: transparent;
  padding: 16px 20px;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease-out;
  margin-left: auto;

  &:focus {
    outline: 2px solid var(--color-text-accent);
  }

  &:hover {
    background-color: var(--color-bg-secondary);
  }

  // SVG icon styles
  svg {
    width: 16px;
    height: 16px;
    stroke: var(--color-text-primary);
    transition: opacity 0.2s ease-out;
  }

  // Default state: show moon icon (for switching to dark mode)
  .sun-icon {
    display: none;
  }

  .moon-icon {
    display: block;
  }
}

// In dark mode: show sun icon (for switching to light mode)
@media (prefers-color-scheme: dark) {
  .dark-mode-toggle {
    .sun-icon {
      display: block;
    }

    .moon-icon {
      display: none;
    }
  }
}

/*--------------------------------------------------------------
# Dark Mode Overrides for Third-party Plugins
--------------------------------------------------------------*/

// Override SyntaxHighlighter plugin with higher specificity
.wp-block-syntaxhighlighter-code,
.syntaxhighlighter-container {
  .syntaxhighlighter {
    background-color: var(--color-bg-secondary) !important;
    color: var(--color-text-primary) !important;

    // Override line backgrounds
    .line.alt1,
    .line.alt2 {
      background-color: var(--color-bg-secondary) !important;
    }

    // Override highlighted lines
    .line.highlighted.alt1,
    .line.highlighted.alt2 {
      background-color: var(--color-border) !important;
    }

    .line.highlighted.number {
      color: var(--color-text-primary) !important;
    }

    // Override table caption
    table caption {
      color: var(--color-text-primary) !important;
    }

    // Override gutter
    .gutter {
      color: var(--color-text-secondary) !important;

      .line {
        border-right: 3px solid var(--color-text-accent) !important;

        &.highlighted {
          background-color: var(--color-text-accent) !important;
          color: var(--color-bg-primary) !important;
        }
      }
    }

    // Override toolbar
    .toolbar {
      color: var(--color-text-primary) !important;
      background: var(--color-text-accent) !important;
      border: none !important;

      a {
        color: var(--color-bg-primary) !important;

        &:hover {
          color: var(--color-text-secondary) !important;
        }
      }
    }

    // Override collapsed toolbar
    &.collapsed .toolbar {
      color: var(--color-text-accent) !important;
      background: var(--color-bg-primary) !important;
      border: 1px solid var(--color-text-accent) !important;

      a {
        color: var(--color-text-accent) !important;

        &:hover {
          color: var(--color-text-secondary) !important;
        }
      }
    }

    // Override syntax colors for dark mode
    .plain,
    .plain a {
      color: var(--color-text-primary) !important;
    }

    .comments,
    .comments a {
      color: #4ade80 !important;
    }

    .string,
    .string a {
      color: #60a5fa !important;
    }

    .keyword {
      color: #a78bfa !important;
      font-weight: bold !important;
    }

    .preprocessor {
      color: var(--color-text-secondary) !important;
    }

    .variable {
      color: #fbbf24 !important;
    }

    .value {
      color: #34d399 !important;
    }

    .functions {
      color: #f472b6 !important;
    }

    .constants {
      color: #06b6d4 !important;
    }

    .script {
      font-weight: bold !important;
      color: #a78bfa !important;
      background-color: transparent !important;
    }

    .color1,
    .color1 a {
      color: var(--color-text-secondary) !important;
    }

    .color2,
    .color2 a {
      color: #f472b6 !important;
    }

    .color3,
    .color3 a {
      color: #ef4444 !important;
    }

    // Override textarea that appears on double-click - multiple selectors for maximum specificity
    textarea,
    textarea.syntaxhighlighter-textarea {
      background-color: var(--color-bg-secondary) !important;
      color: var(--color-text-primary) !important;
      border: 1px solid var(--color-border) !important;
    }
  }
}

// Additional aggressive overrides for SyntaxHighlighter textarea
// Target all textareas in any SyntaxHighlighter context
.syntaxhighlighter textarea,
.syntaxhighlighter-textarea,
textarea.syntaxhighlighter-textarea,
div[class*="syntaxhighlighter"] textarea,
div[id*="highlighter"] textarea,
.container textarea,
div.container textarea,
// Target the specific textarea that appears on double-click
textarea[tc-textcontent],
textarea[data-tc-id],
td.code textarea,
td.code div.container textarea,
// Match the exact specificity that's overriding us
.syntaxhighlighter table td.code .container textarea {
  background-color: var(--color-bg-secondary) !important;
  background: var(--color-bg-secondary) !important;
  color: var(--color-text-primary) !important;
  border: 1px solid var(--color-border) !important;
  font-family: monospace !important;
}

// Additional overrides for common code highlighting plugins
.hljs,
.highlight,
.wp-block-code {
  background-color: var(--color-bg-secondary) !important;
  color: var(--color-text-primary) !important;
}